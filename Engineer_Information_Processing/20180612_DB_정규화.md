정규화  
=====  

# 목차
1. [이상(Anomaly)](#이상anomaly)  
2. [함수적 종속](#함수적-종속)  
3. [정규화](#정규화)  

## 이상(Anomaly)
이상(Anomaly)이란 ***테이블에서 일부 속성들의 종속으로 인해 데이터 중복이 발생하고, 이 중복으로 인해 테이블 조작시 문제가 발생하는 현상***  
* 종류  
  * **삽입이상**  
    * 테이블에 데이터를 삽입할 때 의도와는 상관없이 원하지 않은 값들로 인해 <u>삽입할 수 없게 되는 현상</u>  
  * **삭제이상**  
    * 테이블에서 한 튜플을 삭제할 때 의도와는 상관없는 값들도 함께 삭제되는, 즉 <u>연쇄 삭제</u>가 발생하는 현상  
  * **갱신이상**  
    * 테이블에서 튜플에 있는 속성 값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 <u>불일치성</u>이 생기는 현상  

## 함수적 종속  
### 함수적 종속의 개념  
* 어떤 테이블 R에서 X와 Y를 각각 R의 속성 집합의 부분집합일때,  
속성X가 시간에 관계없이 항상 속성 Y의 값이 <U>**오직 하나만 연관**</U>되어있을때  
Y는 X에 함수적 종속 또는 X가 Y를 함수적으로 결정한다고 하며  
***X->Y*** 로 표기  
* 함수적 종속은 데이터의 의미를 표현하는 것, 현실 세계를 표현하는 제약 조건이 되는 동시에 ***데이터베이스에서 항상 유지되어야 할 조건***  
* 예시  
  * 학생테이블(<u>학번</u>,이름,학년,학과)에서 함수적 종속을 살펴보자  
  * 학생테이블에서 이름 학년 학과는 각각 학번 속성에 함수적 종속이다  
  이를 기호로 표현하면 다음과 같다.  
  학번->이름 / 학번->학년 / 학번->학과  
  <u>이를 줄여 표현하면 학번(**결정자**) -> 이름,학년,학과(**종속자**)</u>  
  ***=> 학생 테이블에서 어떤 학생의 학번이 정해지면,그 학번에 대응하는 이름 학년 학과의 값은 <u>오직 하나만 존재</u>  
  학생 테이블에서 이름 학년 학과가 각각 학번 속성에 함수적 종속적이다는 말은 학번이 결정되면 이름 학년 학과는 항상 학번에 의존적이라는 뜻***  

### 함수적 종속 다이어그램  
* 한 테이블에 존재하는 속성들 간, 복잡한 함수적 종속 관계를 그림으로 표현한 것을 함수적 종속 다이어그램이라함  
* 예시  
  * 수강(<u>학번</u>,<u>과목번호</u>,성적,학년)에서 함수적 종속을 찾고 함수적 종속다이어그램 작성    
    * 순서  
    1. 함수적 종속 관계 작성  
        * 하나의 학번과 과목번호는 하나의 성적과 매칭된다.  
          * 학번,과목번호 -> 성적  
        * 하나의 학번은 하나의 학년에 매칭된다.  
          * 학번 -> 학년  
    2. 다이어그램 작성  
      ![](https://bbungsang.github.io/assets/fd_diagram.png)  

### 완전 함수적 종속 VS 부분 함수적 종속  
* 완전 함수적 종속  
    * 어떤 속성이 기본키에 대해 완전히 종속적일 때를 의미  
      * cf) 수강테이블에서 (<u>학번</u>,<u>과목번호</u>)이 기본키이다. 성적은 학번과 과목번호가 같을 경우에는 항상 같은 성적이 오므로, 즉 성적은 학번과 과목번호에 의해서만 결정되므로 성적은 기본키(학번,과목번호)에 완전 함수적 종속  
* 부분 함수적 종속  
    * 어떤 속성이 기본키에 대해 부분적 종속일때를 의미  
      * cf) 수강테이블에서 (<u>학번</u>,<u>과목번호</u>)이 기본키이다. 학년은 학번만 같을 경우 항상 같은 학년이 오므로, 즉 학년은 학번에만 의해서 결정되므로 기본키(학번,과목번호)에서 부분 함수적 종속  

## 정규화  
### 정규화의 정의, 목적, 형태  
* 정의 : 테이블의 속성들이 상호 종속적인 관계를 갖는 특성을 이용하여 테이블을 무손실 분해하는 과정  
* 목적 : 가능한 한 중복을 제거하여 삽입,삭제,갱신 이상의 발생 가능성을 줄이는 것  
* 정규형의 종류 및 정의  
  * 제 1정규형(1NF)  
    * 테이블 R에 속한 모든 속성값이 원자값으로만 되어있는 정규형  
  * 제 2정규형(2NF)  
    * 테이블 R이 <u>제 1정규형</u>이고, 기본키가 아닌 **모든 속성이 기본키에 대해 완전 함수적 종속을 만족하는 정규형**  
  * 제 3정규형(3NF)  
    * 테이블 R이 <u>제 2정규형</u>이고 기본키가 아닌 **모든 속성이 기본키에 대해 이행적 함수적 종속을 만족하지 않는 정규형**  
  * BCNF  
    * 테이블 R에서 **모든 결정자가 후보키인 정규형**  
    * 일반적으로 <u>제3정규형에 후보키가 여러개 존재하고, 이러한 후보키들이 서로 중첩되어 나타나는 경우에 적용가능</u>  
  * 제 4정규형(4NF)  
    * 테이블 R에 **다중 값 종속이 존재할 경우 R의 모든 속성이 A에 함수적 종속 관계를 만족하는 정규형**  
  * 제 5정규형(5NF)  
    * 테이블 R의 **모든 조인 종속이 R의 후보키를 통해서만 성립되는 정규형**  

### 정규화과정  
주문목록(<u>제품번호</u>,제품명,재고수량,주문번호,고객번호,주소,주문수량)의 테이블이 있다  
그리고 하나의 제품에 대해 여러 개의 주문 관련 정보가 발생 => 현 테이블은 제 1정규형이 아님  
  * 현 테이블을 제 1정규형으로 분리  
    * 제 1정규형의 정의 : 테이블 R에 속한 모든 속성값이 원자값으로만 이뤄진 정규형  
    * 현 테이블에서 반복되는 주문관련정보인 주문번호,고객번호,주소,주문수량을 분리  
    => 제품(<u>제품번호</u>,제품명,재고수량)과 제품주문(<u>제품번호</u>,<u>주문번호</u>,고객번호,주소,주문수량) 테이블로 분리 ***(모든 속성값이 원자값으로만 이뤄져야하니까)***  
    * 다음과 같은 함수적 종속이 존재  
      * 주문번호, 제품번호 -> 고객번호, 주소, 주문수량  
      * 주문번호 -> 고객번호, 주소  
      * 고객번호 -> 주소  
  * 제 1정규화가 완료된 테이블을 제 2정규형으로 분리  
    * 제 2정규형의 정의 : 기본키가 아닌 모든 속성이 기본키에 대하여 완전 함수적 종속을 만족하는 정규형  
    * 주문수량 같은경우 주문번호와 제품번호의 완전 함수적 종속 조건을 만족하지만,  
    나머지 **고객번호 그리고 주소는 주문번호, 고객번호에 완전 함수적 종속조건을 만족하지 않는다.**  
    따라서 완전 함수적 종속을 만족하지 않는 고객번호 그리고 주소 속성을 분리해 또 하나의 테이블로 구성한다.  
    * 제 2정규화 과정 후 다음과 같은 함수적 종속이 존재  
      * 주문번호 -> 고객번호, 주소  
      * 고객번호 -> 주소  
  * 제 2정규화가 완료된 테이블을 제 3정규형으로 분리  
    * 제 3정규형 정의 : 기본키가 아닌 모든 속성의 기본키에 대해 이행적 함수적 종속(A->B이고 B->C일때 A->C를 만족하는 관계)을 만족하지않는 정규형  
    * 제 2정규형을 거친 테이블에서 주문번호->고객번호 , 고객번호 -> 주소의 이행적 함수적 종속관계가 존재하므로 이를 없애줘야한다. 따라서, 제 2정규화를 통해 생성한 주문 테이블을 바탕으로 이행적 함수적 종속을 없애며 테이블을 두개로 나눈다.  

### 역정규화  
* 정규화로 인해 여러 개로 분해된 릴레이션들에서 원하는 정보를 얻기 위해서는 조인을 사용하여 다시 연결해야 하는데, **지나치게 자주 조인을 사용하면 응답 속도가 떨어지므로** <u>정규화에 위배되지만</u> 성능향상을 위해 다시 테이블을 합쳐야한다  
